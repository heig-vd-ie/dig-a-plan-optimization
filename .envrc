export PYTHONPATH=$(pwd)/src
export GRB_LICENSE_FILE=$HOME/gurobi_license/gurobi.lic

export SERVER_JL_PORT=8081
export SERVER_PY_PORT=8001
export SERVER_RAY_PORT=6380
export GRAFANA_PORT=4000
export SERVER_RAY_METRICS_EXPORT_PORT=6381
export SERVER_RAY_DASHBOARD_PORT=8265
export SERVER_MONGODB_PORT=27017

export HEAD_HOST=10.192.189.125
export WORKER_HOST=10.192.189.173
export LOCAL_HOST=0.0.0.0

export SERVER_RAY_ADDRESS=${HEAD_HOST}:${SERVER_RAY_PORT}

# Host info
export CURRENT_HOST=$(hostname -I | awk '{print $1}')
export CURRENT_CPUS=$(nproc)
export CURRENT_RAMS=$(free -m | awk '/^Mem:/{print $2}')
export CURRENT_GPUS=$(which nvidia-smi >/dev/null 2>&1 && nvidia-smi -L | wc -l || echo 0)

# Fractions
export CPU_FRACTION=1.0
export RAM_FRACTION=1.0
export GPU_FRACTION=1.0

# Derived allocations (ensure at least 1 if >0)
export ALLOC_CPUS=$(echo "$CURRENT_CPUS * $CPU_FRACTION" | bc | awk '{print ($1<1?1:int($1))}')
export ALLOC_RAMS=$(echo "$CURRENT_RAMS * $RAM_FRACTION * 1024 * 1024" | bc | awk '{print int($1)}')
export ALLOC_GPUS=$(echo "$CURRENT_GPUS * $GPU_FRACTION" | bc | awk '{print ($1<1?1:int($1))}')

export USE_RAY=true